<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Emerson Neher - Portfolio</title>

  <!-- SEO Meta Tags -->
  <meta name="description"
    content="Emerson Neher - Financial Technology & Information Systems student at WPI. Security enthusiast, game designer, and writer." />
  <meta name="keywords"
    content="Emerson Neher, WPI, Financial Technology, Information Systems, Security, Game Design, TTRPG" />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Roboto:wght@400;500;700&display=swap"
    rel="stylesheet" />

  <style>
    :root {
      --bg-dark: #0a0a0a;
      --bg-light: #f8f8f8;
      --text-light: #00ffcc;
      --text-dark: #222;
      --accent: #00ffcc;
      --accent-hover: #00cc99;
      --accent-alt: #ff00ff;
      --card-bg: rgba(0, 0, 0, 0.85);
      --card-bg-light: rgba(255, 255, 255, 0.92);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html,
    body {
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, var(--bg-dark), #1a1a1a);
      color: var(--text-light);
      font-family: 'Press Start 2P', monospace;
      overflow-x: hidden;
      overflow-y: auto;
    }

    body.light-mode {
      background: var(--bg-light);
      color: var(--text-dark);
    }

    a {
      color: var(--accent);
      text-decoration: none;
      transition: color .2s;
    }

    a:hover {
      color: var(--accent-hover);
      text-decoration: underline;
    }

    .main-container {
      display: grid;
      grid-template-columns: 380px 1fr 380px;
      gap: 24px;
      padding: 24px;
      position: relative;
      z-index: 2;
      min-height: 100vh;
      max-width: 1920px;
      margin: 0 auto;
      align-items: stretch;
    }

    @media (max-width: 1400px) {
      .main-container {
        grid-template-columns: 1fr;
        max-width: 800px;
        height: auto;
      }

      .rss-card,
      .substack-card,
      .markov-card {
        max-width: 100% !important;
        height: auto !important;
      }

      .left-column,
      .right-column {
        height: auto !important;
      }
    }

    .center-card,
    .markov-card,
    .rss-card,
    .substack-card {
      background: var(--card-bg);
      border: 4px solid var(--accent);
      box-shadow: 0 10px 25px rgba(0, 255, 204, 0.3);
      overflow: hidden;
      z-index: 3;
      text-align: center;
      transition: all .4s ease;
      border-radius: 8px;
      display: flex;
      flex-direction: column;
    }

    .center-card:hover,
    .markov-card:hover,
    .rss-card:hover,
    .substack-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 15px 35px rgba(0, 255, 204, 0.4);
    }

    body.light-mode .center-card,
    body.light-mode .markov-card,
    body.light-mode .rss-card,
    body.light-mode .substack-card {
      background: var(--card-bg-light);
      border-color: var(--accent-hover);
    }

    .center-card {
      grid-column: 2;
      padding: 30px;
      justify-content: space-between;
    }

    .left-column {
      grid-column: 1;
      display: flex;
      flex-direction: column;
      gap: 24px;
      height: calc(100vh - 48px);
      position: sticky;
      top: 24px;
    }

    .right-column {
      grid-column: 3;
      display: flex;
      flex-direction: column;
      gap: 24px;
      height: calc(100vh - 48px);
      position: sticky;
      top: 24px;
    }

    @media (max-width: 1400px) {
      .center-card {
        grid-column: 1;
      }

      .left-column,
      .right-column {
        grid-column: 1;
        position: static;
        height: auto;
      }
    }

    .markov-card {
      padding: 20px 15px;
      flex-shrink: 0;
    }

    .substack-card {
      padding: 20px;
      text-align: left;
      flex-grow: 1;
      min-height: 0;
    }

    .rss-card {
      padding: 20px;
      text-align: left;
      flex-grow: 1;
      height: 100%;
      min-height: 0;
    }

    .rss-card h3,
    .substack-card h3 {
      font-size: 1em;
      margin-bottom: 8px;
      color: var(--accent);
      flex-shrink: 0;
    }

    .rss-subtitle,
    .rss-status,
    .rss-footnote {
      flex-shrink: 0;
    }

    .rss-subtitle {
      font-family: 'Roboto', sans-serif;
      font-size: .7em;
      margin-bottom: 10px;
      color: var(--text-light);
    }

    .rss-status {
      font-family: 'Roboto', sans-serif;
      font-size: .7em;
      margin-bottom: 8px;
      color: var(--accent-hover);
    }

    .rss-list,
    .substack-list {
      list-style: none;
      padding: 0;
      margin: 0;
      font-family: 'Roboto', sans-serif;
      font-size: .72em;
      line-height: 1.45;
      overflow-y: auto;
      flex-grow: 1;
      padding-right: 5px;
      max-height: none;
    }

    .rss-item,
    .substack-item {
      padding: 10px;
      margin-bottom: 8px;
      border-left: 3px solid var(--accent);
      background: rgba(0, 255, 204, 0.05);
      transition: all .3s ease;
    }

    .rss-item:hover,
    .substack-item:hover {
      background: rgba(0, 255, 204, 0.1);
      border-left-width: 5px;
      transform: translateX(4px);
    }

    .rss-item a,
    .substack-item a {
      color: var(--accent-alt);
      font-weight: 500;
      display: block;
      margin-bottom: 4px;
    }

    .rss-item-meta {
      font-size: .65em;
      opacity: 0.8;
      margin-top: 2px;
    }

    .rss-item-excerpt {
      font-size: .7em;
      opacity: 0.7;
      margin-top: 6px;
      line-height: 1.4;
    }

    .rss-footnote {
      display: block;
      margin-top: 8px;
      font-family: 'Roboto', sans-serif;
      font-size: .6em;
      opacity: 0.7;
    }

    .card-buttons {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      gap: 8px;
      margin-bottom: 15px;
      flex-shrink: 0;
    }

    .card-btn,
    .toggle-theme-btn {
      background: var(--accent);
      color: #000;
      border: 2px solid var(--accent);
      padding: 10px 22px;
      font-family: 'Roboto', sans-serif;
      font-size: .75em;
      text-transform: uppercase;
      font-weight: bold;
      cursor: pointer;
      transition: all .3s ease;
      border-radius: 4px;
    }

    .card-btn:hover,
    .toggle-theme-btn:hover {
      background: var(--accent-hover);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 255, 204, 0.3);
    }

    body.light-mode .card-btn,
    body.light-mode .toggle-theme-btn {
      background: var(--accent-hover);
      border-color: var(--accent-hover);
      color: #fff;
    }

    .card-image {
      margin: 0 auto 15px;
      width: 200px;
      height: 200px;
      border: 3px solid var(--accent);
      border-radius: 50%;
      overflow: hidden;
      position: relative;
      transition: all .4s ease;
      flex-shrink: 0;
    }

    .card-image:hover {
      transform: scale(1.05);
      box-shadow: 0 0 30px rgba(0, 255, 204, 0.5);
      border-width: 4px;
    }

    .card-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .contact-card {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .contact-card h1 {
      margin: 8px 0;
      font-size: 1.5em;
      color: var(--accent);
      text-shadow: 0 0 10px rgba(0, 255, 204, 0.3);
    }

    .contact-card h3 {
      margin: 4px 0 15px;
      font-size: .9em;
      color: var(--accent-hover);
    }

    .contact-card p {
      margin: 4px 0;
      font-family: 'Roboto', sans-serif;
      font-size: .78em;
      color: var(--text-light);
    }

    .contact-card .links a {
      color: var(--accent-alt);
      margin: 0 6px;
    }

    .bio {
      margin-top: 10px;
      font-family: 'Roboto', sans-serif;
      font-size: .75em;
      line-height: 1.5;
      color: var(--text-light);
    }

    .spotify-container {
      margin-top: 20px;
      background: rgba(0, 0, 0, 0.8);
      border: 2px solid var(--accent);
      box-shadow: 0 2px 8px rgba(0, 255, 204, 0.3);
      padding: 10px;
      border-radius: 8px;
      flex-shrink: 0;
    }

    .spotify-title {
      margin: 0 0 8px;
      font-family: 'Roboto', sans-serif;
      font-size: 1em;
      color: var(--accent);
    }

    .tiles-container {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 1;
    }

    .moving-tile {
      position: absolute;
      background-size: cover;
      background-position: center;
      border: 2px solid var(--accent);
      box-shadow: 0 4px 10px rgba(0, 255, 204, 0.3);
      animation: drift 25s linear forwards;
      mix-blend-mode: screen;
      opacity: 0.6;
    }

    @keyframes drift {
      0% {
        transform: translateX(-150vw) scale(1);
        opacity: 0;
      }

      10% {
        opacity: .6;
      }

      50% {
        transform: translateX(50vw) scale(1.05);
      }

      90% {
        opacity: .3;
      }

      100% {
        transform: translateX(150vw) scale(1);
        opacity: 0;
      }
    }

    #markovQuote {
      font-family: 'Roboto', sans-serif;
      font-size: .78em;
      line-height: 1.55;
      margin-top: 8px;
      min-height: 60px;
    }

    .modal {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.85);
      display: flex;
      justify-content: center;
      align-items: center;
      backdrop-filter: blur(5px);
      z-index: 10;
    }

    .modal.hidden {
      display: none;
    }

    .modal-content {
      position: relative;
      background: var(--card-bg);
      padding: 30px;
      width: 90%;
      max-width: 480px;
      border: 2px solid var(--accent);
      box-shadow: 0 0 30px rgba(0, 255, 204, 0.6);
      text-align: center;
      font-family: 'Roboto', sans-serif;
      color: var(--text-light);
      border-radius: 8px;
    }

    body.light-mode .modal-content {
      background: var(--card-bg-light);
      border-color: var(--accent-hover);
      color: var(--text-dark);
    }

    .close-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      background: transparent;
      border: none;
      font-size: 24px;
      color: var(--text-light);
      cursor: pointer;
    }

    .close-btn:hover {
      color: var(--accent-hover);
    }

    body.light-mode .close-btn {
      color: var(--text-dark);
    }

    /* Scrollbar styling */
    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: rgba(0, 0, 0, 0.3);
    }

    ::-webkit-scrollbar-thumb {
      background: var(--accent);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--accent-hover);
    }
  </style>
</head>

<body>

  <div class="main-container">

    <!-- Left Column -->
    <div class="left-column">
      <!-- Substack Blog Feed -->
      <div class="substack-card">
        <h3>Hopeless Poetic</h3>
        <p class="rss-subtitle">Latest from my Substack</p>
        <div id="substackStatus" class="rss-status">Loading posts…</div>
        <ul id="substackFeed" class="substack-list"></ul>
        <span class="rss-footnote">
          <a href="https://emersonneher.substack.com" target="_blank">Visit Hopeless Poetic →</a>
        </span>
      </div>

      <!-- Markov Generator Card -->
      <div class="markov-card">
        <h3>Emerson's Wisdom</h3>
        <div id="markovQuote">Click below to generate...</div>
        <button id="regenerateBtn" class="card-btn">Bestow Wisdom</button>
      </div>
    </div>

    <!-- Center Card -->
    <div class="center-card">
      <div class="card-buttons">
        <button id="themeToggleBtn" class="toggle-theme-btn">Toggle Theme</button>
        <a href="axial/axialcharactersheet.html" class="card-btn">Axial TTRPG</a>
        <a href="dm-screen/index.html" class="card-btn">DM Screen</a>
        <a href="https://emersonneher.substack.com" target="_blank" class="card-btn">Hopeless Poetic</a>
        <button id="miscBtn" class="card-btn">Miscellaneous</button>
      </div>

      <div class="card-image">
        <img src="assets/images/sittingimage.jpg" alt="Emerson Neher" />
      </div>

      <div class="contact-card">
        <h1>Emerson Neher</h1>
        <h3>they/them/theirs</h3>
        <p>Email: <a href="mailto:emersonneher@gmail.com">emersonneher@gmail.com</a></p>
        <p>Worcester, MA & Evergreen, CO</p>
        <p>
          Worcester Polytechnic Institute | Class of 2028<br />
          Financial Technology Major | Information Systems Major
        </p>
        <p class="links">
          <a href="https://www.linkedin.com/in/emerson-neher-184274346" target="_blank">LinkedIn</a> |
          <a href="https://www.instagram.com/emerson.neher/" target="_blank">Instagram</a> |
          <a href="https://discord.com/users/noblejace" target="_blank">Discord</a>
        </p>
        <p class="bio">
          Passionate about security, technology, and system design. I'm a writer, game designer,
          and storyteller who loves poetry, the mechanics of RPGs,
          and the art of photography. I am also deeply fascinated by security and the systems that minimize risk in our
          world. If you can't break it, it can't be fixed.
        </p>
      </div>

      <div class="spotify-container">
        <div class="spotify-title">Currently Listening</div>
        <iframe src="https://open.spotify.com/embed/playlist/0FdmEAvUL4hFCzBDev8n6J?utm_source=generator&theme=1"
          width="100%" height="180" frameborder="0"
          allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy">
        </iframe>
      </div>
    </div>

    <!-- Right Column -->
    <div class="right-column">
      <!-- RSS / Interests Feed Card -->
      <div class="rss-card">
        <h3>Interest Feed</h3>
        <p class="rss-subtitle">Fintech, security, RPGs, poetry, and more.</p>
        <div id="rssStatus" class="rss-status">Loading latest posts…</div>
        <ul id="rssFeed" class="rss-list"></ul>
        <span class="rss-footnote">
          All in good fun.
        </span>
      </div>
    </div>
  </div>

  <!-- Floating Image Tiles -->
  <div class="tiles-container"></div>

  <!-- Miscellaneous Modal -->
  <div id="miscModal" class="modal hidden">
    <div class="modal-content">
      <button id="closeModal" class="close-btn" aria-label="Close">&times;</button>
      <h2>Miscellaneous Projects</h2>
      <p>Explore extra snippets, downloads, and fun experiments.</p>
      <ul style="list-style:none;line-height:1.8;padding:0;margin-top:1em;">
        <li><a href="resume.pdf" download>Download my resume</a></li>
        <li><a href="Omega/index.html" target="_blank">Portfolio Optimizer (Omega API)</a></li>
        <li><a href="https://open.spotify.com/playlist/3vDF8HiTd7JqePb8OrA4vA?si=59d7ce28997841d1"
            target="_blank">Favorite Playlist</a></li>
        <li><a href="https://hopelesspoetic.com/weakestlink.html" target="_blank">Weakest&nbsp;Link (MKT4030)</a></li>
        <li><a href="systemgen.html" target="_blank">Astral Axial (Legacy)</a></li>
        <li><a href="zwerchau/index.html" target="_blank">Zwerchau (Security Consulting)</a></li>
      </ul>
    </div>
  </div>
  fetch('assets/data/emersonmarkovchain.txt')
  .then(r => r.text())
  .then(raw => {
  // Clean text but KEEP punctuation
  // Remove HTML tags, keep words and punctuation
  const cleanText = raw
  .replace(/<[^>]+>/g, '')
    .replace(/\r\n/g, ' ')
    .replace(/\n/g, ' ');

    window.markov.train(cleanText);

    // Wire up UI
    const out = document.getElementById('markovQuote');
    const btn = document.getElementById('regenerateBtn');

    btn.onclick = () => {
    out.textContent = window.markov.generate(5, 25);
    };

    // Generate initial quote
    out.textContent = window.markov.generate(5, 25);
    })
    .catch(err => {
    console.error('Markov error:', err);
    document.getElementById('markovQuote').textContent = 'Failed to load wisdom corpus.';
    });

    // ============================================
    // THEME TOGGLE
    // ============================================
    document.getElementById('themeToggleBtn')
    .addEventListener('click', () => document.body.classList.toggle('light-mode'));

    // ============================================
    // FLOATING TILES
    // ============================================
    const tilePaths = Array.from({ length: 34 }, (_, i) => `assets/images/${i + 4}.jpg`);
    const tilesContainer = document.querySelector('.tiles-container');
    const tileData = [];
    let tileLoaded = 0;

    tilePaths.forEach(src => {
    const img = new Image();
    img.src = src;
    img.onload = () => {
    tileData.push({ src, aspect: img.width / img.height || 1 });
    checkTiles();
    };
    img.onerror = checkTiles;
    });

    function checkTiles() {
    if (++tileLoaded === tilePaths.length) {
    spawnTile();
    setInterval(() => tilesContainer.children.length < 5 && spawnTile(), 2000); } } function spawnTile() { if
      (!tileData.length) return; const { src, aspect }=tileData[Math.random() * tileData.length | 0]; const
      el=document.createElement('div'), w=150 + Math.random() * 250, h=w / aspect; el.className='moving-tile' ;
      el.style.width=w + 'px' ; el.style.height=h + 'px' ; el.style.top=Math.random() * (window.innerHeight - h) + 'px'
      ; el.style.backgroundImage=`url('${src}')`; el.onanimationend=()=> el.remove();
      tilesContainer.appendChild(el);
      }

      // ============================================
      // MODAL HANDLERS
      // ============================================
      const miscModal = document.getElementById('miscModal');
      document.getElementById('miscBtn').onclick = () => miscModal.classList.remove('hidden');
      document.getElementById('closeModal').onclick = () => miscModal.classList.add('hidden');
      miscModal.onclick = e => e.target === miscModal && miscModal.classList.add('hidden');

      // ============================================
      // SUBSTACK RSS FEED
      // ============================================
      const substackListEl = document.getElementById('substackFeed');
      const substackStatusEl = document.getElementById('substackStatus');

      async function loadSubstack() {
      try {
      substackStatusEl.textContent = 'Loading posts…';
      const response = await fetch(
      'https://api.rss2json.com/v1/api.json?rss_url=' +
      encodeURIComponent('https://emersonneher.substack.com/feed')
      );

      if (!response.ok) throw new Error('Failed to fetch');

      const data = await response.json();

      if (data && data.status === 'ok' && Array.isArray(data.items)) {
      substackStatusEl.textContent = 'Latest posts:';

      data.items.slice(0, 15).forEach(item => {
      const li = document.createElement('li');
      li.className = 'substack-item';

      const link = document.createElement('a');
      link.href = item.link;
      link.target = '_blank';
      link.rel = 'noopener noreferrer';
      link.textContent = item.title;
      li.appendChild(link);

      const meta = document.createElement('div');
      meta.className = 'rss-item-meta';
      const date = new Date(item.pubDate);
      meta.textContent = date.toLocaleDateString(undefined, {
      year: 'numeric',
      month: 'short',
      day: 'numeric'
      });
      li.appendChild(meta);

      // Add excerpt if available
      if (item.description) {
      const excerpt = document.createElement('div');
      excerpt.className = 'rss-item-excerpt';
      const tempDiv = document.createElement('div');
      tempDiv.innerHTML = item.description;
      const text = tempDiv.textContent || tempDiv.innerText || '';
      excerpt.textContent = text.substring(0, 150) + (text.length > 150 ? '...' : '');
      li.appendChild(excerpt);
      }

      substackListEl.appendChild(li);
      });
      } else {
      substackStatusEl.textContent = 'No posts available.';
      }
      } catch (e) {
      console.error('Substack error:', e);
      substackStatusEl.textContent = 'Failed to load posts.';
      }
      }

      // ============================================
      // ENHANCED RSS FEED
      // ============================================
      const rssListEl = document.getElementById('rssFeed');
      const rssStatusEl = document.getElementById('rssStatus');

      const rssFeeds = [
      {
      label: 'Fintech',
      url: 'https://www.finextra.com/rss/headlines.aspx?channel=fintech'
      },
      {
      label: 'InfoSec',
      url: 'https://feeds.feedburner.com/TheHackersNews'
      },
      {
      label: 'World News',
      url: 'https://apnews.com/index.rss'
      },
      {
      label: 'Cybersecurity',
      url: 'https://www.schneier.com/blog/atom.xml'
      },
      {
      label: 'RPG Design',
      url: 'https://www.enworld.org/ewr-porta/index.rss'
      },
      {
      label: 'Tech News',
      url: 'https://hnrss.org/frontpage'
      },
      {
      label: 'Game Dev',
      url: 'https://www.gamedeveloper.com/rss.xml'
      },
      {
      label: 'Poetry',
      url: 'https://feeds.megaphone.fm/the-daily-poem'
      },
      {
      label: 'RPG Theory',
      url: 'https://thealexandrian.net/feed'
      },
      {
      label: 'DM Advice',
      url: 'https://slyflourish.com/index.xml'
      },
      {
      label: 'System Design',
      url: 'http://feeds.feedburner.com/HighScalability'
      },
      {
      label: 'Hank Green',
      url: 'https://www.youtube.com/feeds/videos.xml?channel_id=UCOT2iLov0V7Re7ku_3UBtcQ'
      }
      ];

      const allItems = [];

      function formatDate(d) {
      const date = new Date(d);
      if (isNaN(date.getTime())) return '';
      return date.toLocaleDateString(undefined, {
      year: 'numeric',
      month: 'short',
      day: 'numeric'
      });
      }

      function renderRSS() {
      rssListEl.innerHTML = '';
      if (!allItems.length) {
      rssStatusEl.textContent = 'No items loaded yet. Try refreshing in a bit.';
      return;
      }

      rssStatusEl.textContent = 'Latest from across my obsessions:';
      allItems
      .sort((a, b) => (b.pubDate || 0) - (a.pubDate || 0))
      .slice(0, 20)
      .forEach(item => {
      const li = document.createElement('li');
      li.className = 'rss-item';

      const link = document.createElement('a');
      link.href = item.link;
      link.target = '_blank';
      link.rel = 'noopener noreferrer';
      link.textContent = item.title;
      li.appendChild(link);

      const meta = document.createElement('div');
      meta.className = 'rss-item-meta';
      meta.textContent = `${item.label} • ${formatDate(item.pubDateRaw)}`;
      li.appendChild(meta);

      // Add excerpt if available
      if (item.description) {
      const excerpt = document.createElement('div');
      excerpt.className = 'rss-item-excerpt';
      const tempDiv = document.createElement('div');
      tempDiv.innerHTML = item.description;
      const text = tempDiv.textContent || tempDiv.innerText || '';
      excerpt.textContent = text.substring(0, 120) + (text.length > 120 ? '...' : '');
      li.appendChild(excerpt);
      }

      rssListEl.appendChild(li);
      });
      }

      async function loadRSS() {
      rssStatusEl.textContent = 'Loading latest posts…';
      for (const feed of rssFeeds) {
      try {
      const response = await fetch(
      'https://api.rss2json.com/v1/api.json?rss_url=' +
      encodeURIComponent(feed.url)
      );
      if (!response.ok) continue;
      const data = await response.json();
      if (data && data.status === 'ok' && Array.isArray(data.items)) {
      data.items.slice(0, 5).forEach(item => {
      allItems.push({
      label: feed.label,
      title: item.title,
      link: item.link,
      description: item.description || item.content || '',
      pubDateRaw: item.pubDate,
      pubDate: new Date(item.pubDate).getTime() || 0
      });
      });
      }
      } catch (e) {
      console.error(`Error loading ${feed.label}:`, e);
      }
      }
      renderRSS();
      }

      // Initialize feeds
      loadSubstack();
      loadRSS();
      </script>
</body>

</html>